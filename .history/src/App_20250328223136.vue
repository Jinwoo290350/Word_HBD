<template>
  <div class="container mt-5">
    <h1 class="text-center mb-4">ğŸ‚ à¸ªà¸£à¹‰à¸²à¸‡à¸ˆà¸”à¸«à¸¡à¸²à¸¢à¸­à¸§à¸¢à¸à¸£à¸ªà¸¸à¸”à¸à¸´à¹€à¸¨à¸© ğŸ‰</h1>
    <div class="card p-4 shadow">
      <div class="mb-3">
        <label class="form-label">à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¸ªà¹ˆà¸‡:</label>
        <input 
          v-model="senderName" 
          type="text" 
          class="form-control" 
          placeholder="à¹€à¸Šà¹ˆà¸™ à¹à¸Ÿà¸£à¸‡à¸„à¹Œà¸œà¸¹à¹‰à¸¢à¸´à¹ˆà¸‡à¹ƒà¸«à¸à¹ˆ"
        >
      </div>

      <div class="mb-3">
        <label class="form-label">à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¸£à¸±à¸š:</label>
        <input 
          v-model="nickname" 
          type="text" 
          class="form-control" 
          placeholder="à¹€à¸Šà¹ˆà¸™ à¸™à¹‰à¸­à¸‡à¹‚à¸šà¹Šà¸—à¸ªà¸¸à¸”à¸™à¹ˆà¸²à¸£à¸±à¸"
          required
        >
      </div>
      
      <div class="mb-3">
        <label class="form-label">à¸ªà¹„à¸•à¸¥à¹Œà¸à¸²à¸£à¸­à¸§à¸¢à¸à¸£:</label>
        <select v-model="theme" class="form-select">
          <option value="à¸‹à¸´à¸à¸¡à¹ˆà¸² à¸«à¸¡à¸²à¸›à¹ˆà¸² à¸«à¸¡à¸²à¸›à¹ˆà¸²à¸—à¸µà¹ˆà¸à¸¹à¸”à¸ à¸²à¸©à¸²à¸„à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰">ğŸº Sigma Wolf</option>
          <option value="à¸­à¸­à¸—à¸´à¸ªà¸•à¸´à¸ à¸ˆà¸°à¸à¸´à¸¡à¸à¹Œà¹„à¸¡à¹ˆà¸–à¸¸à¸à¹à¸¥à¸°à¹„à¸¡à¹ˆà¹€à¸›à¹‡à¸™à¸„à¸³à¸ à¸²à¸©à¸²à¸ˆà¸°à¸­à¸­à¸à¸¡à¸²à¹€à¸à¸·à¹ˆà¸­à¸™à¹†">ğŸ§© à¸­à¸­à¸—à¸´à¸ªà¸•à¸´à¸</option>
          <option value="à¸„à¸™à¸”à¸³ à¸à¸¹à¸”à¸ˆà¸²à¹„à¸¡à¹ˆà¸”à¸µ à¸Šà¸­à¸šà¹€à¸¥à¹ˆà¸™à¸šà¸²à¸ª à¸à¸´à¸™à¹„à¸à¹ˆà¸—à¸­à¸”à¸à¸±à¸šà¹à¸•à¸‡à¹‚à¸¡">ğŸ‘¨ğŸ¿ Ninja (Maybe)</option>
          <option value="à¸‹à¸±à¸à¹€à¸à¸­à¸£à¹Œà¹à¸”à¸”à¸”à¸µà¹‰ à¸£à¸§à¸¢ à¸Šà¸­à¸šà¹à¸ˆà¸à¸•à¸±à¸‡à¸„à¹Œ">ğŸ’µ Sugardaddy</option>
          <option value="à¹‚à¸£à¸šà¸¥à¹‡à¸­à¸à¸‹à¹Œ à¸Šà¸§à¸™à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¡à¹‚à¸£à¸šà¸¥à¹‡à¸­à¸">ğŸ® Roblox Master</option>
          <option value="à¸­à¸´à¸ªà¸¥à¸²à¸¡ à¸ˆà¸°à¸à¸´à¸¡à¸à¹Œà¸ à¸²à¸©à¸²à¸­à¸²à¸«à¸¥à¸±à¸š">ğŸ•Œ Islamic Style</option>
          <option value="à¸„à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›">ğŸ˜Š à¸—à¸±à¹ˆà¸§à¹„à¸›</option>
          <option value="à¸„à¸™à¹€à¸­à¹€à¸Šà¸µà¸¢ à¸—à¸µà¹ˆà¸Šà¸­à¸šà¸–à¸²à¸¡à¸§à¹ˆà¸²à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸£à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸«à¸¡à¸­">ğŸ‘¨âš•ï¸ Asian Parent</option>
          <option value="à¸„à¸™à¸«à¸¢à¸²à¸šà¸„à¸²à¸¢">ğŸ¤¬ à¸ªà¸¸à¸”à¹€à¸—à¹ˆ(à¹à¸•à¹ˆà¸”à¸¸à¸”à¸±à¸™)</option>
        </select>
      </div>

      <button 
        @click="generateWishes" 
        class="btn btn-primary"
        :disabled="isLoading || !nickname || !senderName"
      >
        <template v-if="!isLoading">
          âœ¨ à¹€à¸£à¸´à¹ˆà¸¡à¸ªà¸£à¹‰à¸²à¸‡à¸¡à¸«à¸±à¸¨à¸ˆà¸£à¸£à¸¢à¹Œ
        </template>
        <template v-else>
          ğŸ”® à¸à¸³à¸¥à¸±à¸‡à¸šà¸´à¸”à¹€à¸šà¸·à¸­à¸™à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ˆà¸£à¸´à¸‡...
        </template>
      </button>
    </div>

    <div v-if="result" class="letter-box mt-4 p-4 shadow">
      <div class="envelope-icon">âœ‰ï¸</div>
      <h2 class="text-center mb-3">à¸–à¸¶à¸‡ {{ nickname }} à¸—à¸µà¹ˆà¸£à¸±à¸...</h2>
      <div class="letter-content">{{ result }}</div>
      <button 
        @click="copyText"
        class="btn btn-copy mt-3"
        :class="{ 'copy-success': copySuccess }"
      >
        {{ copySuccess ? 'âœ… à¸„à¸±à¸”à¸¥à¸­à¸à¹à¸¥à¹‰à¸§!' : 'ğŸ“„ à¸„à¸±à¸”à¸¥à¸­à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡' }}
      </button>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      senderName: '',
      nickname: '',
      theme: 'à¸„à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›',
      isLoading: false,
      result: '',
      copySuccess: false
    }
  },
  methods: {
    async generateWishes() {
      this.isLoading = true
      try {
        const prompt = [
          `à¹€à¸‚à¸µà¸¢à¸™à¸ˆà¸”à¸«à¸¡à¸²à¸¢à¸­à¸§à¸¢à¸à¸£à¸§à¸±à¸™à¹€à¸à¸´à¸”à¸ˆà¸²à¸ ${this.senderName} à¸–à¸¶à¸‡ ${this.nickname} à¹ƒà¸™à¸ªà¹„à¸•à¸¥à¹Œ ${this.theme}`,
          'à¸£à¸¹à¸›à¹à¸šà¸šà¸ˆà¸”à¸«à¸¡à¸²à¸¢à¸ªà¸±à¹‰à¸™à¹† 2-3 à¸¢à¹ˆà¸­à¸«à¸™à¹‰à¸²',
          'à¹ƒà¸Šà¹‰à¸ à¸²à¸©à¸²à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸•à¸²à¸¡à¸˜à¸µà¸¡à¸—à¸µà¹ˆà¹€à¸¥à¸·à¸­à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸„à¸£à¹ˆà¸‡à¸„à¸£à¸±à¸”',
          'à¹ƒà¸ªà¹ˆà¹€à¸­à¹‚à¸¡à¸ˆà¸´à¹ƒà¸«à¹‰à¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¸à¸±à¸šà¹€à¸™à¸·à¹‰à¸­à¸«à¸²',
          `à¸¥à¸‡à¸—à¹‰à¸²à¸¢à¸”à¹‰à¸§à¸¢ "${this.senderName}" à¹ƒà¸™à¸£à¸¹à¸›à¹à¸šà¸šà¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸ªà¸£à¸£à¸„à¹Œ`
        ].join('. ')

        const response = await fetch('https://api.opentyphoon.ai/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer sk-3wY19YJQdjyYVBnwdjZKlpa3X7KG58tACnkPuAaH5rT8k70u'
          },
          body: JSON.stringify({
            model: "typhoon-v2-70b-instruct",
            messages: [{ role: "user", content: prompt }],
            temperature: 0.9
          })
        })

        if (!response.ok) throw new Error('API Error')
        
        const data = await response.json()
        this.result = data.choices[0].message.content
      } catch (error) {
        console.error('à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”:', error)
        this.result = 'ğŸŒ€ à¹€à¸§à¸¥à¸²à¹à¸¥à¸°ç©ºé–“à¸šà¸´à¸”à¹€à¸šà¸µà¹‰à¸¢à¸§! à¸à¸£à¸¸à¸“à¸²à¸—à¸³à¸à¸²à¸£à¸—à¸§à¸™à¸„à¸§à¸­à¸™à¸•à¸±à¸¡à¸£à¸±à¸...'
      } finally {
        this.isLoading = false
      }
    },
    async copyText() {
      try {
        await navigator.clipboard.writeText(this.result)
        this.copySuccess = true
        setTimeout(() => this.copySuccess = false, 2000)
      } catch (err) {
        alert('à¸£à¸°à¸šà¸šà¸„à¸¥à¸´à¸›à¸šà¸­à¸£à¹Œà¸”à¸›à¸à¸´à¹€à¸ªà¸˜à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡!')
      }
    }
  }
}
</script>

<style>
/* à¹€à¸à¸´à¹ˆà¸¡à¸ªà¹„à¸•à¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆ */
.form-control {
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.form-control:focus {
  border-color: #ebbcba !important;
  box-shadow: 0 0 0 3px rgba(235, 188, 186, 0.25) !important;
}

.btn-copy {
  background: #ebbcba !important;
  color: #191724 !important;
  border: none !important;
  padding: 10px 20px !important;
  border-radius: 8px !important;
  transition: all 0.3s ease !important;
}

.btn-copy.copy-success {
  background: #9fcc8a !important;
}

.btn-copy:hover {
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 12px rgba(235, 188, 186, 0.3) !important;
}

/* à¸›à¸£à¸±à¸šà¸à¸²à¸£à¹Œà¸”à¸ªà¸³à¸«à¸£à¸±à¸šà¸¡à¸·à¸­à¸–à¸·à¸­ */
@media (max-width: 576px) {
  .card {
    border-radius: 10px;
    padding: 15px;
  }
  
  h1 {
    font-size: 1.8rem;
  }
  
  .form-control, .form-select {
    font-size: 14px;
  }
  
  .btn-primary {
    font-size: 15px;
  }
}

/* à¹€à¸à¸´à¹ˆà¸¡à¹€à¸­à¸Ÿà¹€à¸Ÿà¸à¸•à¹Œà¸à¸´à¹€à¸¨à¸© */
.letter-content {
  position: relative;
  background: linear-gradient(45deg, #191724, #1f1d2e);
  padding: 25px;
  border-radius: 12px;
  border: 1px solid #ebbcba;
}

.letter-content::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><text x="50%" y="50%" font-size="40" fill="%23ebbcba22" dominant-baseline="middle" text-anchor="middle">${props => props.theme}</text></svg>');
  opacity: 0.1;
  pointer-events: none;
}
</style>